{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Obligation</title>
     <script src="{% static 'node_modules/jquery/dist/jquery.min.js' %}"></script>
    <script src="{% static 'node_modules/bootstrap/dist/js/bootstrap.min.js' %}"></script>
    <link rel="stylesheet" href="{% static 'node_modules/bootstrap/dist/css/bootstrap.min.css' %}">
    <link rel="icon" href="{% static '../../media/img/tulip.png' %}">
</head>
<body>
{% include 'components/teacher-navs.html' %}
<table class="table table-bordered">
    <thead>
    <tr>
        {#        <th scope="col">#</th>#}
        <th scope="col">Action</th>
        <th scope="col">Nama</th>
        <th scope="col">PLP</th>
        <th scope="col">Obligasi</th>

    </tr>
    </thead>
    <tbody id="obligation">

    </tbody>
</table>

<script>
let urls = '{% url 'json-student' %}'
    let iHtml = ``
     $.get(urls, {}, function (data) {
         let id_student = Object.keys(data)
         for (let i = 0; i<id_student.length; i++){
             let Data = data[id_student[i]]
             let _id_student = id_student[i]
             let _name_student = Data["Name"]
             let _plp_student = Data["PLP"]
             let key_result = Object.keys(Data["Result"])
             console.log(key_result.length)
             iHtml+=`<tr>
                    <td rowspan="${key_result.length}">
                    <button onclick="edit('${_id_student}')" class="btn btn-info">Edit</button>
                    </td>
                    <td rowspan="${key_result.length}">${_name_student}</td>
                    <td rowspan="${key_result.length}">${_plp_student}</td>
                    `
             for(_i= 0; _i< key_result.length; _i++){
                 try {
                 let Result = Data["Result"][key_result[_i]]
                 let _mapel = Result["Mapel"]
                 console.log(_mapel)
                     iHtml += `<td>${_mapel}</td>`
                 }catch (e) {
                      iHtml += `<td></td>`
                 }
                  iHtml += `</tr><tr>`
             }
              iHtml+=`</tr>`
         }
         $('#obligation').html(iHtml)
     })

    function edit(id) {
        window.location.href="/obligation-edit?id="+id
    }
</script>
</body>
</html>